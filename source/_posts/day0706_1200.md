---
title: "XGboost & LightGBM"
date: '2022-07-06'
---



## XGboost & LightGBM (2016-2017)
- 전통적인 머신러닝 알고리즘의 융합
 + 선형회귀 릿지 라쏘, 과적합 방지 위한 규제
 + 결정트리의 핵심적인 알고리즘
 + 경사하강법
 + 부스팅 기법
- 문제점 : 파라미터의 개수가 매우 많음
- 왜 많이 쓸까요?
 + 모델학습 속도 
 + 성능 
 + 가장 좋은 모델이란, 학습속도는 빠르면서 성능은 좋은 것(지금까지 나온 알고리즘보다)
- Python
 + JAVA, C, C++
 + C, C++ / r data.table 패키지 
- 큰 회사들 개발
 + 첫 번째 옵션, 우리가 자체적으로 배포하자-> Pyhthon Wrapper API
 + R, 머신러닝 프레임워크 종류 다양
 + 파이썬 머신러닝 = Scikit-Learn에서 쉽게 쓸 수 있도록 개발, Scikit-Learn 
 
 참고 https://xgboost.readthedocs.io/en/stable/python/python_intro.html 

 


#  XGboost (Scikit-Learn API방식 & python Wrapper 방식)

### python Wrapper 방식
- X_train, y_train



```python
import xgboost as xgb 
from sklearn.model_selection import train_test_split
import seaborn as sns 

# 데이터 분리
titanic = sns.load_dataset('titanic')
# titanic.info()

# X, 독립변수, y 종속변수
X = titanic[['pclass', 'parch', 'fare']]
y = titanic['survived']

# 훈련데이터, 테스트 데이터 분리
X_train, X_test, y_train, y_test = train_test_split(X, 
                                                    y, 
                                                    stratify = y, 
                                                    test_size = 0.3, 
                                                    random_state=42)

X_train.shape, X_test.shape, y_train.shape, y_test.shape
```




    ((623, 3), (268, 3), (623,), (268,))



- 여기가 핵심



```python
dtrain = xgb.DMatrix(data = X_train, label = y_train)
dtest = xgb.DMatrix(data=X_test, label=y_test)

print(dtrain)

```

    <xgboost.core.DMatrix object at 0x7fc937b31ad0>
    


```python
#max_depth = 트리의 깊이
#n_estimator = 트리의 수


params = {
    'max_depth' : 3, 
    'n_estimators' : 100, 
    'eta' : 0.1, 
    'objective' : 'binary:logistic'
}
num_rounds = 400

w_list = [(dtrain, 'train'), (dtest, 'test')]
xgb_ml = xgb.train(params = params, 
                   dtrain = dtrain, 
                   num_boost_round = 400, 
                   early_stopping_rounds = 100, 
                   evals = w_list)
```

    [0]	train-error:0.260032	test-error:0.302239
    Multiple eval metrics have been passed: 'test-error' will be used for early stopping.
    
    Will train until test-error hasn't improved in 100 rounds.
    [1]	train-error:0.260032	test-error:0.302239
    [2]	train-error:0.260032	test-error:0.302239
    [3]	train-error:0.260032	test-error:0.302239
    [4]	train-error:0.260032	test-error:0.302239
    [5]	train-error:0.260032	test-error:0.302239
    [6]	train-error:0.260032	test-error:0.302239
    [7]	train-error:0.260032	test-error:0.302239
    [8]	train-error:0.260032	test-error:0.302239
    [9]	train-error:0.260032	test-error:0.302239
    [10]	train-error:0.260032	test-error:0.302239
    [11]	train-error:0.260032	test-error:0.302239
    [12]	train-error:0.260032	test-error:0.302239
    [13]	train-error:0.247191	test-error:0.298507
    [14]	train-error:0.247191	test-error:0.298507
    [15]	train-error:0.248796	test-error:0.302239
    [16]	train-error:0.248796	test-error:0.302239
    [17]	train-error:0.248796	test-error:0.302239
    [18]	train-error:0.248796	test-error:0.302239
    [19]	train-error:0.248796	test-error:0.302239
    [20]	train-error:0.248796	test-error:0.302239
    [21]	train-error:0.248796	test-error:0.302239
    [22]	train-error:0.248796	test-error:0.302239
    [23]	train-error:0.248796	test-error:0.302239
    [24]	train-error:0.248796	test-error:0.302239
    [25]	train-error:0.248796	test-error:0.302239
    [26]	train-error:0.248796	test-error:0.302239
    [27]	train-error:0.248796	test-error:0.302239
    [28]	train-error:0.247191	test-error:0.302239
    [29]	train-error:0.247191	test-error:0.302239
    [30]	train-error:0.247191	test-error:0.302239
    [31]	train-error:0.243981	test-error:0.298507
    [32]	train-error:0.247191	test-error:0.302239
    [33]	train-error:0.243981	test-error:0.298507
    [34]	train-error:0.243981	test-error:0.298507
    [35]	train-error:0.242376	test-error:0.294776
    [36]	train-error:0.24077	test-error:0.294776
    [37]	train-error:0.24077	test-error:0.294776
    [38]	train-error:0.24077	test-error:0.294776
    [39]	train-error:0.24077	test-error:0.294776
    [40]	train-error:0.24077	test-error:0.294776
    [41]	train-error:0.24077	test-error:0.294776
    [42]	train-error:0.24077	test-error:0.294776
    [43]	train-error:0.24077	test-error:0.294776
    [44]	train-error:0.24077	test-error:0.302239
    [45]	train-error:0.24077	test-error:0.302239
    [46]	train-error:0.24077	test-error:0.302239
    [47]	train-error:0.24077	test-error:0.302239
    [48]	train-error:0.24077	test-error:0.302239
    [49]	train-error:0.24077	test-error:0.302239
    [50]	train-error:0.24077	test-error:0.302239
    [51]	train-error:0.24077	test-error:0.302239
    [52]	train-error:0.23435	test-error:0.302239
    [53]	train-error:0.23435	test-error:0.302239
    [54]	train-error:0.232745	test-error:0.298507
    [55]	train-error:0.229535	test-error:0.298507
    [56]	train-error:0.229535	test-error:0.298507
    [57]	train-error:0.229535	test-error:0.298507
    [58]	train-error:0.229535	test-error:0.298507
    [59]	train-error:0.227929	test-error:0.294776
    [60]	train-error:0.227929	test-error:0.298507
    [61]	train-error:0.227929	test-error:0.298507
    [62]	train-error:0.227929	test-error:0.298507
    [63]	train-error:0.227929	test-error:0.298507
    [64]	train-error:0.227929	test-error:0.298507
    [65]	train-error:0.227929	test-error:0.298507
    [66]	train-error:0.227929	test-error:0.298507
    [67]	train-error:0.227929	test-error:0.298507
    [68]	train-error:0.227929	test-error:0.298507
    [69]	train-error:0.227929	test-error:0.298507
    [70]	train-error:0.227929	test-error:0.298507
    [71]	train-error:0.227929	test-error:0.298507
    [72]	train-error:0.227929	test-error:0.302239
    [73]	train-error:0.227929	test-error:0.302239
    [74]	train-error:0.229535	test-error:0.30597
    [75]	train-error:0.229535	test-error:0.30597
    [76]	train-error:0.229535	test-error:0.30597
    [77]	train-error:0.229535	test-error:0.30597
    [78]	train-error:0.229535	test-error:0.30597
    [79]	train-error:0.229535	test-error:0.30597
    [80]	train-error:0.229535	test-error:0.30597
    [81]	train-error:0.229535	test-error:0.30597
    [82]	train-error:0.229535	test-error:0.30597
    [83]	train-error:0.229535	test-error:0.30597
    [84]	train-error:0.229535	test-error:0.30597
    [85]	train-error:0.229535	test-error:0.30597
    [86]	train-error:0.229535	test-error:0.30597
    [87]	train-error:0.229535	test-error:0.30597
    [88]	train-error:0.229535	test-error:0.30597
    [89]	train-error:0.229535	test-error:0.30597
    [90]	train-error:0.229535	test-error:0.30597
    [91]	train-error:0.229535	test-error:0.30597
    [92]	train-error:0.229535	test-error:0.30597
    [93]	train-error:0.229535	test-error:0.30597
    [94]	train-error:0.227929	test-error:0.313433
    [95]	train-error:0.226324	test-error:0.313433
    [96]	train-error:0.223114	test-error:0.317164
    [97]	train-error:0.223114	test-error:0.317164
    [98]	train-error:0.223114	test-error:0.317164
    [99]	train-error:0.223114	test-error:0.317164
    [100]	train-error:0.223114	test-error:0.317164
    [101]	train-error:0.223114	test-error:0.317164
    [102]	train-error:0.223114	test-error:0.317164
    [103]	train-error:0.223114	test-error:0.317164
    [104]	train-error:0.223114	test-error:0.317164
    [105]	train-error:0.223114	test-error:0.317164
    [106]	train-error:0.223114	test-error:0.317164
    [107]	train-error:0.223114	test-error:0.317164
    [108]	train-error:0.223114	test-error:0.317164
    [109]	train-error:0.223114	test-error:0.317164
    [110]	train-error:0.223114	test-error:0.317164
    [111]	train-error:0.223114	test-error:0.317164
    [112]	train-error:0.223114	test-error:0.317164
    [113]	train-error:0.223114	test-error:0.317164
    [114]	train-error:0.223114	test-error:0.317164
    [115]	train-error:0.223114	test-error:0.317164
    [116]	train-error:0.223114	test-error:0.317164
    [117]	train-error:0.223114	test-error:0.317164
    [118]	train-error:0.223114	test-error:0.317164
    [119]	train-error:0.223114	test-error:0.317164
    [120]	train-error:0.223114	test-error:0.317164
    [121]	train-error:0.223114	test-error:0.317164
    [122]	train-error:0.223114	test-error:0.317164
    [123]	train-error:0.223114	test-error:0.317164
    [124]	train-error:0.224719	test-error:0.317164
    [125]	train-error:0.224719	test-error:0.317164
    [126]	train-error:0.224719	test-error:0.317164
    [127]	train-error:0.221509	test-error:0.317164
    [128]	train-error:0.223114	test-error:0.317164
    [129]	train-error:0.219904	test-error:0.313433
    [130]	train-error:0.215088	test-error:0.313433
    [131]	train-error:0.215088	test-error:0.313433
    [132]	train-error:0.215088	test-error:0.313433
    [133]	train-error:0.215088	test-error:0.313433
    [134]	train-error:0.215088	test-error:0.313433
    [135]	train-error:0.215088	test-error:0.313433
    Stopping. Best iteration:
    [35]	train-error:0.242376	test-error:0.294776
    
    


```python
# 평가
from sklearn.metrics import accuracy_score
pred_probs = xgb_ml.predict(dtest)
y_pred = [1 if x> 0.5 else 0 for x in pred_probs]

# 예측 라벨과 실제 라벨 사이의 정확도 측정
accuracy_score(y_pred, y_test)
```




    0.6865671641791045



### Scikit-Learn API방식



```python
from sklearn.tree import DecisionTreeClassifier
from xgboost import XGBClassifier # API 

# dt = DecisionTreeClassifier()
xgb_model = XGBClassifier(objective = 'binary:logistic', 
                          n_estimators=100, 
                          max_depth=3, 
                          learning_rate = 0.1, 
                          num_rounds = 400,
                          random_state=42)

w_list = [(X_train, y_train), (X_test, y_test)]

xgb_model.fit(X_train, y_train, eval_set = w_list, eval_metric='error', verbose=True)

y_probas = xgb_model.predict_proba(X_test)
y_pred = [1 if x > 0.5 else 0 for x in pred_probs]

# 예측 라벨과 실제 라벨 사이의 정확도 측정
accuracy_score(y_pred, y_test)

```

    [0]	validation_0-error:0.260032	validation_1-error:0.302239
    [1]	validation_0-error:0.260032	validation_1-error:0.302239
    [2]	validation_0-error:0.260032	validation_1-error:0.302239
    [3]	validation_0-error:0.260032	validation_1-error:0.302239
    [4]	validation_0-error:0.260032	validation_1-error:0.302239
    [5]	validation_0-error:0.260032	validation_1-error:0.302239
    [6]	validation_0-error:0.260032	validation_1-error:0.302239
    [7]	validation_0-error:0.260032	validation_1-error:0.302239
    [8]	validation_0-error:0.260032	validation_1-error:0.302239
    [9]	validation_0-error:0.260032	validation_1-error:0.302239
    [10]	validation_0-error:0.260032	validation_1-error:0.302239
    [11]	validation_0-error:0.260032	validation_1-error:0.302239
    [12]	validation_0-error:0.260032	validation_1-error:0.302239
    [13]	validation_0-error:0.247191	validation_1-error:0.298507
    [14]	validation_0-error:0.247191	validation_1-error:0.298507
    [15]	validation_0-error:0.248796	validation_1-error:0.302239
    [16]	validation_0-error:0.248796	validation_1-error:0.302239
    [17]	validation_0-error:0.248796	validation_1-error:0.302239
    [18]	validation_0-error:0.248796	validation_1-error:0.302239
    [19]	validation_0-error:0.248796	validation_1-error:0.302239
    [20]	validation_0-error:0.248796	validation_1-error:0.302239
    [21]	validation_0-error:0.248796	validation_1-error:0.302239
    [22]	validation_0-error:0.248796	validation_1-error:0.302239
    [23]	validation_0-error:0.248796	validation_1-error:0.302239
    [24]	validation_0-error:0.248796	validation_1-error:0.302239
    [25]	validation_0-error:0.248796	validation_1-error:0.302239
    [26]	validation_0-error:0.248796	validation_1-error:0.302239
    [27]	validation_0-error:0.248796	validation_1-error:0.302239
    [28]	validation_0-error:0.247191	validation_1-error:0.302239
    [29]	validation_0-error:0.247191	validation_1-error:0.302239
    [30]	validation_0-error:0.247191	validation_1-error:0.302239
    [31]	validation_0-error:0.243981	validation_1-error:0.298507
    [32]	validation_0-error:0.247191	validation_1-error:0.302239
    [33]	validation_0-error:0.243981	validation_1-error:0.298507
    [34]	validation_0-error:0.243981	validation_1-error:0.298507
    [35]	validation_0-error:0.242376	validation_1-error:0.294776
    [36]	validation_0-error:0.24077	validation_1-error:0.294776
    [37]	validation_0-error:0.24077	validation_1-error:0.294776
    [38]	validation_0-error:0.24077	validation_1-error:0.294776
    [39]	validation_0-error:0.24077	validation_1-error:0.294776
    [40]	validation_0-error:0.24077	validation_1-error:0.294776
    [41]	validation_0-error:0.24077	validation_1-error:0.294776
    [42]	validation_0-error:0.24077	validation_1-error:0.294776
    [43]	validation_0-error:0.24077	validation_1-error:0.294776
    [44]	validation_0-error:0.24077	validation_1-error:0.302239
    [45]	validation_0-error:0.24077	validation_1-error:0.302239
    [46]	validation_0-error:0.24077	validation_1-error:0.302239
    [47]	validation_0-error:0.24077	validation_1-error:0.302239
    [48]	validation_0-error:0.24077	validation_1-error:0.302239
    [49]	validation_0-error:0.24077	validation_1-error:0.302239
    [50]	validation_0-error:0.24077	validation_1-error:0.302239
    [51]	validation_0-error:0.24077	validation_1-error:0.302239
    [52]	validation_0-error:0.23435	validation_1-error:0.302239
    [53]	validation_0-error:0.23435	validation_1-error:0.302239
    [54]	validation_0-error:0.232745	validation_1-error:0.298507
    [55]	validation_0-error:0.229535	validation_1-error:0.298507
    [56]	validation_0-error:0.229535	validation_1-error:0.298507
    [57]	validation_0-error:0.229535	validation_1-error:0.298507
    [58]	validation_0-error:0.229535	validation_1-error:0.298507
    [59]	validation_0-error:0.227929	validation_1-error:0.294776
    [60]	validation_0-error:0.227929	validation_1-error:0.298507
    [61]	validation_0-error:0.227929	validation_1-error:0.298507
    [62]	validation_0-error:0.227929	validation_1-error:0.298507
    [63]	validation_0-error:0.227929	validation_1-error:0.298507
    [64]	validation_0-error:0.227929	validation_1-error:0.298507
    [65]	validation_0-error:0.227929	validation_1-error:0.298507
    [66]	validation_0-error:0.227929	validation_1-error:0.298507
    [67]	validation_0-error:0.227929	validation_1-error:0.298507
    [68]	validation_0-error:0.227929	validation_1-error:0.298507
    [69]	validation_0-error:0.227929	validation_1-error:0.298507
    [70]	validation_0-error:0.227929	validation_1-error:0.298507
    [71]	validation_0-error:0.227929	validation_1-error:0.298507
    [72]	validation_0-error:0.227929	validation_1-error:0.302239
    [73]	validation_0-error:0.227929	validation_1-error:0.302239
    [74]	validation_0-error:0.229535	validation_1-error:0.30597
    [75]	validation_0-error:0.229535	validation_1-error:0.30597
    [76]	validation_0-error:0.229535	validation_1-error:0.30597
    [77]	validation_0-error:0.229535	validation_1-error:0.30597
    [78]	validation_0-error:0.229535	validation_1-error:0.30597
    [79]	validation_0-error:0.229535	validation_1-error:0.30597
    [80]	validation_0-error:0.229535	validation_1-error:0.30597
    [81]	validation_0-error:0.229535	validation_1-error:0.30597
    [82]	validation_0-error:0.229535	validation_1-error:0.30597
    [83]	validation_0-error:0.229535	validation_1-error:0.30597
    [84]	validation_0-error:0.229535	validation_1-error:0.30597
    [85]	validation_0-error:0.229535	validation_1-error:0.30597
    [86]	validation_0-error:0.229535	validation_1-error:0.30597
    [87]	validation_0-error:0.229535	validation_1-error:0.30597
    [88]	validation_0-error:0.229535	validation_1-error:0.30597
    [89]	validation_0-error:0.229535	validation_1-error:0.30597
    [90]	validation_0-error:0.229535	validation_1-error:0.30597
    [91]	validation_0-error:0.229535	validation_1-error:0.30597
    [92]	validation_0-error:0.229535	validation_1-error:0.30597
    [93]	validation_0-error:0.229535	validation_1-error:0.30597
    [94]	validation_0-error:0.227929	validation_1-error:0.313433
    [95]	validation_0-error:0.226324	validation_1-error:0.313433
    [96]	validation_0-error:0.223114	validation_1-error:0.317164
    [97]	validation_0-error:0.223114	validation_1-error:0.317164
    [98]	validation_0-error:0.223114	validation_1-error:0.317164
    [99]	validation_0-error:0.223114	validation_1-error:0.317164
    




    0.6865671641791045



- p275 = Scikit-Learn API방식
- Scikit-Learn API방식, python Wrapper 방식 비교하기 

# lightGBM Python Wrapper 방식 & LightGBM Scikit-Learn API방식

## lightGBM Python Wrapper 방식

참고 https://lightgbm.readthedocs.io/en/latest/Parameters.html


```python
import lightgbm as lgb 
from sklearn.model_selection import train_test_split 
from sklearn.metrics import accuracy_score
import seaborn as sns 

# tips 데이터셋 
titanic = sns.load_dataset('titanic')

X = titanic[['pclass', 'parch', 'fare']]
y = titanic['survived']

# 훈련데이터, 테스트 데이터 분리
X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = 0.3, random_state=42)

# XGBoost 코드와 유사하다. 
dtrain = lgb.Dataset(data = X_train, label = y_train)
dtest = lgb.Dataset(data = X_test, label = y_test)

params = {'max_depth':3,
          'n_estimators':100,
          'learning_rate': 0.1,
          'objective':'binary',
          'metric' : 'binary_error', 
          'num_boost_round' : 400, 
          'verbose' : 1} 

w_list = [dtrain, dtest]
lgb_ml = lgb.train(params=params, train_set = dtrain,\
                  early_stopping_rounds=100, valid_sets= w_list)

pred_probs = lgb_ml.predict(X_test)
y_pred=[1 if x > 0.5 else 0 for x in pred_probs]

# 예측 라벨과 실제 라벨 사이의 정확도 측정
accuracy_score(y_pred, y_test)
```

    /usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:118: UserWarning: Found `num_boost_round` in params. Will use it instead of argument
      warnings.warn("Found `{}` in params. Will use it instead of argument".format(alias))
    

    [1]	training's binary_error: 0.383628	valid_1's binary_error: 0.384328
    Training until validation scores don't improve for 100 rounds.
    [2]	training's binary_error: 0.383628	valid_1's binary_error: 0.384328
    [3]	training's binary_error: 0.354735	valid_1's binary_error: 0.369403
    [4]	training's binary_error: 0.29695	valid_1's binary_error: 0.354478
    [5]	training's binary_error: 0.272873	valid_1's binary_error: 0.33209
    [6]	training's binary_error: 0.272873	valid_1's binary_error: 0.33209
    [7]	training's binary_error: 0.269663	valid_1's binary_error: 0.317164
    [8]	training's binary_error: 0.269663	valid_1's binary_error: 0.317164
    [9]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [10]	training's binary_error: 0.269663	valid_1's binary_error: 0.309701
    [11]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [12]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [13]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [14]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [15]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [16]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [17]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [18]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [19]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [20]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [21]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [22]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [23]	training's binary_error: 0.271268	valid_1's binary_error: 0.313433
    [24]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [25]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [26]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [27]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [28]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [29]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [30]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [31]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [32]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [33]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [34]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [35]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [36]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [37]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [38]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [39]	training's binary_error: 0.248796	valid_1's binary_error: 0.309701
    [40]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [41]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [42]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [43]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [44]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [45]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [46]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [47]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [48]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [49]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [50]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [51]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [52]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [53]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [54]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [55]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [56]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [57]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [58]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [59]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [60]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [61]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [62]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [63]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [64]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [65]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [66]	training's binary_error: 0.243981	valid_1's binary_error: 0.309701
    [67]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [68]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [69]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [70]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [71]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [72]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [73]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [74]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [75]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [76]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [77]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [78]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [79]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [80]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [81]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [82]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [83]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [84]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [85]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [86]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [87]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [88]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [89]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [90]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [91]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [92]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [93]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [94]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [95]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [96]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [97]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [98]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [99]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [100]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [101]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    [102]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    [103]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [104]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [105]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [106]	training's binary_error: 0.224719	valid_1's binary_error: 0.313433
    [107]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [108]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [109]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [110]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [111]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [112]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [113]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [114]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [115]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [116]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [117]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [118]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [119]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [120]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [121]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [122]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [123]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [124]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [125]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [126]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [127]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [128]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [129]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [130]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [131]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [132]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [133]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [134]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [135]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [136]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [137]	training's binary_error: 0.219904	valid_1's binary_error: 0.309701
    [138]	training's binary_error: 0.219904	valid_1's binary_error: 0.309701
    [139]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [140]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [141]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [142]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [143]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [144]	training's binary_error: 0.221509	valid_1's binary_error: 0.320896
    [145]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [146]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [147]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [148]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [149]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [150]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [151]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [152]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [153]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [154]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [155]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [156]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [157]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [158]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [159]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [160]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [161]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [162]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [163]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [164]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [165]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [166]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [167]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [168]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [169]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [170]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [171]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [172]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [173]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [174]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [175]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [176]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [177]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [178]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [179]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [180]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [181]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [182]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [183]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [184]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [185]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [186]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [187]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [188]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [189]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [190]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [191]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [192]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [193]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [194]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [195]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [196]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [197]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [198]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [199]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [200]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [201]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    Early stopping, best iteration is:
    [101]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    




    0.6940298507462687



## LightGBM Scikit-Learn API방식


```python
from lightgbm import LGBMClassifier
from sklearn.metrics import accuracy_score

# model 
w_list = [dtrain, dtest]
model = LGBMClassifier(objective = 'binary', 
                       metric = 'binary_error',
                       n_estimators=100, 
                       learning_rate=0.1, 
                       max_depth=3, 
                       num_boost_round = 400,
                       random_state = 32)
model.fit(X_train, 
          y_train, 
          eval_set = [(X_train, y_train), (X_test, y_test)], 
          verbose=1,
          early_stopping_rounds = 100)
y_probas = model.predict_proba(X_test) 
y_pred=[1 if x > 0.5 else 0 for x in y_probas[:, 1]] # 예측 라벨(0과 1로 예측)

# 예측 라벨과 실제 라벨 사이의 정확도 측정
accuracy_score(y_pred, y_test)








```

    /usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:118: UserWarning: Found `num_boost_round` in params. Will use it instead of argument
      warnings.warn("Found `{}` in params. Will use it instead of argument".format(alias))
    

    [1]	training's binary_error: 0.383628	valid_1's binary_error: 0.384328
    Training until validation scores don't improve for 100 rounds.
    [2]	training's binary_error: 0.383628	valid_1's binary_error: 0.384328
    [3]	training's binary_error: 0.354735	valid_1's binary_error: 0.369403
    [4]	training's binary_error: 0.29695	valid_1's binary_error: 0.354478
    [5]	training's binary_error: 0.272873	valid_1's binary_error: 0.33209
    [6]	training's binary_error: 0.272873	valid_1's binary_error: 0.33209
    [7]	training's binary_error: 0.269663	valid_1's binary_error: 0.317164
    [8]	training's binary_error: 0.269663	valid_1's binary_error: 0.317164
    [9]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [10]	training's binary_error: 0.269663	valid_1's binary_error: 0.309701
    [11]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [12]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [13]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [14]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [15]	training's binary_error: 0.264848	valid_1's binary_error: 0.309701
    [16]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [17]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [18]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [19]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [20]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [21]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [22]	training's binary_error: 0.266453	valid_1's binary_error: 0.313433
    [23]	training's binary_error: 0.271268	valid_1's binary_error: 0.313433
    [24]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [25]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [26]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [27]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [28]	training's binary_error: 0.258427	valid_1's binary_error: 0.309701
    [29]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [30]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [31]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [32]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [33]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [34]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [35]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [36]	training's binary_error: 0.255217	valid_1's binary_error: 0.309701
    [37]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [38]	training's binary_error: 0.255217	valid_1's binary_error: 0.317164
    [39]	training's binary_error: 0.248796	valid_1's binary_error: 0.309701
    [40]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [41]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [42]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [43]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [44]	training's binary_error: 0.248796	valid_1's binary_error: 0.313433
    [45]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [46]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [47]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [48]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [49]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [50]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [51]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [52]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [53]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [54]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [55]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [56]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [57]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [58]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [59]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [60]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [61]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [62]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [63]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [64]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [65]	training's binary_error: 0.247191	valid_1's binary_error: 0.313433
    [66]	training's binary_error: 0.243981	valid_1's binary_error: 0.309701
    [67]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [68]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [69]	training's binary_error: 0.23435	valid_1's binary_error: 0.309701
    [70]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [71]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [72]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [73]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [74]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [75]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [76]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [77]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [78]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [79]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [80]	training's binary_error: 0.232745	valid_1's binary_error: 0.313433
    [81]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [82]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [83]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [84]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [85]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [86]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [87]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [88]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [89]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [90]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [91]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [92]	training's binary_error: 0.229535	valid_1's binary_error: 0.309701
    [93]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [94]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [95]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [96]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [97]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [98]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [99]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [100]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [101]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    [102]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    [103]	training's binary_error: 0.227929	valid_1's binary_error: 0.309701
    [104]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [105]	training's binary_error: 0.221509	valid_1's binary_error: 0.317164
    [106]	training's binary_error: 0.224719	valid_1's binary_error: 0.313433
    [107]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [108]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [109]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [110]	training's binary_error: 0.224719	valid_1's binary_error: 0.317164
    [111]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [112]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [113]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [114]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [115]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [116]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [117]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [118]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [119]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [120]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [121]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [122]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [123]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [124]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [125]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [126]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [127]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [128]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [129]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [130]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [131]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [132]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [133]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [134]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [135]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [136]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [137]	training's binary_error: 0.219904	valid_1's binary_error: 0.309701
    [138]	training's binary_error: 0.219904	valid_1's binary_error: 0.309701
    [139]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [140]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [141]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [142]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [143]	training's binary_error: 0.223114	valid_1's binary_error: 0.309701
    [144]	training's binary_error: 0.221509	valid_1's binary_error: 0.320896
    [145]	training's binary_error: 0.223114	valid_1's binary_error: 0.313433
    [146]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [147]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [148]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [149]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [150]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [151]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [152]	training's binary_error: 0.221509	valid_1's binary_error: 0.313433
    [153]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [154]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [155]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [156]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [157]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [158]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [159]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [160]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [161]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [162]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [163]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [164]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [165]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [166]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [167]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [168]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [169]	training's binary_error: 0.219904	valid_1's binary_error: 0.324627
    [170]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [171]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [172]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [173]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [174]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [175]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [176]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [177]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [178]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [179]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [180]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [181]	training's binary_error: 0.221509	valid_1's binary_error: 0.328358
    [182]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [183]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [184]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [185]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [186]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [187]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [188]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [189]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [190]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [191]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [192]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [193]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [194]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [195]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [196]	training's binary_error: 0.216693	valid_1's binary_error: 0.320896
    [197]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [198]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [199]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [200]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    [201]	training's binary_error: 0.215088	valid_1's binary_error: 0.317164
    Early stopping, best iteration is:
    [101]	training's binary_error: 0.23114	valid_1's binary_error: 0.30597
    




    0.6940298507462687


